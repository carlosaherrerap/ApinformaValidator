<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tokenizer Huancayo ‚Äî Verificaci√≥n Segura</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
</head>

<body>

    <div class="main-card">
        <!--  PASO 1: DATOS PERSONALES -->
        <div id="step1" class="step active">
            <div class="step-indicator">Paso 1 de 4</div>
            <div class="step-title">Datos Personales</div>
            <div class="step-subtitle">Ingrese su informaci√≥n para iniciar el registro</div>

            <div class="mb-3">
                <label class="form-label">Tipo de Documento</label>
                <select id="tipo_doc" class="form-select" onchange="onTipoDocChange()">
                    <option value="DNI">DNI (8 d√≠gitos)</option>
                    <option value="RUC">RUC (11 d√≠gitos)</option>
                    <option value="CDE">Carnet Extranjer√≠a (9 d√≠gitos)</option>
                </select>
            </div>
            <div class="row g-2 mb-3">
                <div class="col-8">
                    <label class="form-label">Documento</label>
                    <input type="text" id="documento" class="form-control" placeholder="12345678" maxlength="8"
                        oninput="onlyNumbers(this)">
                </div>
                <div class="col-4">
                    <label class="form-label">D.V.</label>
                    <input type="text" id="dv" class="form-control" placeholder="0" maxlength="1"
                        oninput="onlyNumbers(this)">
                </div>
            </div>
            <div class="mb-3">
                <label class="form-label">Nombres</label>
                <input type="text" id="nombres" class="form-control" placeholder="Juan" oninput="onlyLetters(this)">
            </div>
            <div class="row g-2 mb-4">
                <div class="col-6">
                    <label class="form-label">Ap. Paterno</label>
                    <input type="text" id="ap_paterno" class="form-control" placeholder="P√©rez"
                        oninput="onlyLetters(this)">
                </div>
                <div class="col-6">
                    <label class="form-label">Ap. Materno</label>
                    <input type="text" id="ap_materno" class="form-control" placeholder="G√≥mez"
                        oninput="onlyLetters(this)">
                </div>
            </div>
            <button class="btn-main" onclick="submitStep1()">Siguiente ‚Üí</button>
        </div>

        <!--  PASO 2: CELULAR + MEDIO -->
        <div id="step2" class="step">
            <div class="step-indicator">Paso 2 de 4</div>
            <div class="step-title">Verificar Celular</div>
            <div class="step-subtitle">Le enviaremos un c√≥digo de verificaci√≥n</div>

            <div class="mb-3">
                <label class="form-label">N√∫mero Celular</label>
                <div class="input-group">
                    <span class="input-group-text">+51</span>
                    <input type="text" id="celular" class="form-control" placeholder="900000000" maxlength="9"
                        oninput="onlyNumbers(this)" style="border-radius: 0 12px 12px 0;">
                </div>
            </div>
            <div class="mb-3">
                <label class="form-label">Operador</label>
                <select id="operador" class="form-select">
                    <option value="MOVISTAR">MOVISTAR</option>
                    <option value="CLARO">CLARO</option>
                    <option value="ENTEL">ENTEL</option>
                    <option value="BITEL">BITEL</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="form-label">Medio de Verificaci√≥n</label>
                <div class="medio-options">
                    <div class="medio-option">
                        <input type="radio" name="via" id="via-sms" value="S" checked onchange="onViaChange()">
                        <label for="via-sms">
                            <span class="icon">üì±</span>
                            SMS
                            <span id="cooldown-S" class="cooldown-badge">‚è≥ --:--</span>
                        </label>
                    </div>
                    <div class="medio-option">
                        <input type="radio" name="via" id="via-wa" value="W" onchange="onViaChange()">
                        <label for="via-wa">
                            <span class="icon">üí¨</span>
                            WhatsApp
                            <span id="cooldown-W" class="cooldown-badge">‚è≥ --:--</span>
                        </label>
                    </div>
                </div>
            </div>
            <button class="btn-main" id="btn-verificar" onclick="submitStep2()">
                üîí Verificar Celular ‚Üí
            </button>
            <button class="btn-back" onclick="goStep(1)">‚Üê Volver</button>
        </div>

        <!--  PASO 4: DATOS FINALES -->
        <div id="step4" class="step">
            <div class="step-indicator">Paso 4 de 4</div>
            <div class="step-title">Finalizar Registro</div>
            <div class="step-subtitle">Complete sus datos para terminar</div>

            <div class="mb-3">
                <label class="form-label">Correo Electr√≥nico</label>
                <input type="email" id="email" class="form-control" placeholder="usuario@ejemplo.com">
            </div>
            <div class="mb-3">
                <label class="form-label">Ubicaci√≥n</label>
                <div class="row g-2">
                    <div class="col-4"><input type="text" id="dept" class="form-control" placeholder="Depto."></div>
                    <div class="col-4"><input type="text" id="prov" class="form-control" placeholder="Prov."></div>
                    <div class="col-4"><input type="text" id="dist" class="form-control" placeholder="Distr."></div>
                </div>
            </div>
            <div class="form-check mb-4" style="padding-left: 0;">
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                    <input type="checkbox" id="accept" onchange="onAcceptChange()"
                        style="width:18px;height:18px;accent-color:var(--accent);">
                    <span style="font-size:0.82rem; color:var(--text-muted);">Acepto los t√©rminos y condiciones</span>
                </label>
            </div>
            <button class="btn-main" id="btn-registrar" onclick="submitStep4()" disabled>
                ‚úì Registrar
            </button>
        </div>

        <!--  PASO FINAL: √âXITO -->
        <div id="step-success" class="step">
            <div class="success-icon">‚úì</div>
            <div class="step-title">¬°Registro Exitoso!</div>
            <div class="step-subtitle">Su informaci√≥n ha sido registrada y validada correctamente.</div>
            <div class="help-footer" style="border:none;">
                <p style="color:var(--success); font-weight:600;">Verificaci√≥n completada</p>
            </div>
        </div>
    </div>

    <!--  MODAL DE VERIFICACI√ìN (PASO 3)  -->
    <div class="modal-overlay" id="tokenModal">
        <div class="modal-card">
            <button onclick="closeModal()"
                style="position:absolute;top:16px;right:20px;background:none;border:none;color:var(--text-muted);font-size:1.2rem;cursor:pointer;">‚úï</button>

            <div class="step-indicator">Paso 3 de 4</div>
            <div class="step-title" style="font-size:1.3rem;">Verificar Token</div>
            <div class="step-subtitle" id="modal-subtitle">Ingrese el c√≥digo enviado a su celular</div>

            <!--  input de TOKEN -->
            <div class="token-inputs" id="token-inputs"></div>

            <!--  tiempo MIN:SEC -->
            <div class="timer-display">
                <div>
                    <div class="timer-block" id="timer-min">02</div>
                    <div class="timer-label">MIN</div>
                </div>
                <div class="timer-colon">:</div>
                <div>
                    <div class="timer-block" id="timer-sec">30</div>
                    <div class="timer-label">SEC</div>
                </div>
            </div>

            <!--  intentos restantes -->
            <div class="attempts-badge" id="attempts-badge">
                üõ°Ô∏è <span id="attempts-text">3 intentos restantes</span>
            </div>

            <!--  mensaje de error -->
            <div class="error-msg" id="modal-error"></div>

            <!-- Expire message -->
            <div class="expire-msg" id="expire-msg">
                ¬øNo le lleg√≥ el token a tiempo?<br><strong>Pruebe solicitarlo por WhatsApp</strong>
            </div>

            <!--  barra de seguridad -->
            <div class="security-bar">
                <div class="security-bar-header">
                    <span style="color:var(--text-muted)">Security Check</span>
                    <span id="security-label" style="color:var(--success);font-weight:600;">Strong</span>
                </div>
                <div class="security-bar-track">
                    <div class="security-bar-fill" id="security-fill" style="width:100%"></div>
                </div>
            </div>

            <button class="btn-main" style="margin-top:20px;" onclick="submitVerify()">
                Verify & Continue ‚Üí
            </button>

            <div class="modal-actions">
                <button class="btn-cancel" onclick="cancelModal()">CANCELAR</button>
                <button class="btn-resend" id="btn-resend" onclick="resendToken()" disabled>RE-ENVIAR</button>
            </div>

            <div class="help-footer">
                ¬øProblemas? <a href="#">Obtener Ayuda</a>
            </div>
        </div>
    </div>

    <!--  modal de ya registrado -->
    <div class="modal-overlay" id="alreadyModal">
        <div class="modal-card">
            <div style="font-size:2.5rem;margin-bottom:12px;">‚ö†Ô∏è</div>
            <div class="step-title" style="font-size:1.2rem;">Ya registrado</div>
            <div class="step-subtitle">Usted ya se ha registrado y validado anteriormente. No puede continuar.</div>
            <button class="btn-main"
                onclick="document.getElementById('alreadyModal').classList.remove('active')">Entendido</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="admin.js"></script>
</body>

</html>